<div class="contents">

  <h1> Total spend to date: </h1>
  <h1 class="big_numbers"> <%= @total_spend %> </h1>

  <div class="table_group">

    <div class="top_box">
    <h2 class = "transaction_title"> Split by merchant </h2>
      <div class="button_box">
      <a class="breakdown_button" href="/bonzabudgeting/spendbytag"> View spend breakdown by tag </a>
      <a class="breakdown_button" href="/bonzabudgeting/spendbymerchant"> View spend breakdown by merchant </a>
      <a class="breakdown_button" href="/bonzabudgeting/spendbymonth"> View spend breakdown by month </a>
      <a class="breakdown_button" href="/bonzabudgeting"> View all transactions </a>
    </div>
  </div>

  <a class="add_new_button" href="/bonzabudgeting/new"> Add New Transaction </a>

    <table>
      <tr>
        <th> Merchant </th>
        <th> Spend </th>
        <th class="percentage"> Percentage of total spend </th>
      </tr>

      <% running_total = 0 %>
      <% @merchants.each() do |merchant| %>
      <tr>
        <td><%= merchant.name() %></td>
        <td><%= merchant.total_spend() %></td>
        <td class="percentage"><%= percentage_of_total(merchant.total_spend(), @total_spend) %></td>
        <td class="no_border">
            <a class="view_edit_button" href="/bonzabudgeting/spendbymerchant/<%= merchant.id() %>">
              View transactions </a>
        </td>
      </tr>
      <% running_total += merchant.total_spend()[1..-1].to_f() %>
      <% end %>
      <% total_summed = add_currency_sign('%.2f' % running_total) %>

      <tr >
        <td class="no_border"></td>
        <td class="no_border"><b><%= @total_spend %></b></td>
        <td class="no_border_percentage">
          <b><%= percentage_of_total(total_summed, @total_spend) %></b>
        </td>
      </tr>
    </table>

  </div>

</div>
